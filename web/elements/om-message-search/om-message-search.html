<dom-module id="om-message-search">
  <template>
    <style is="custom-style">
      :host {
        @apply(--layout-fit);

        --paper-toolbar-background: #fefefe;
        --paper-toolbar-color: var(--paper-grey-700, #aaa);

        top: 0;
      }

      #message-search {
        @apply(--shadow-elevation-2dp);
      }

      #message-search-input {
        @apply(--layout-flex);

        background: transparent;
        border-width: 0;
        font-size: 16px;
        outline: none;
        width: 100vw;
      }
    </style>
    <paper-toolbar id="message-search">
      <paper-icon-button icon="arrow-back" on-tap="_hideSearch"></paper-icon-button>
      <input is="iron-input"
        id="message-search-input"
        placeholder="Messages"
        bind-value="{{query}}">
        <paper-icon-button
          hidden$="[[_blank(query)]]"
          icon="help-outline"></paper-icon-button>
        <paper-icon-button
          hidden$="[[!_blank(query)]]"
          on-tap="_resetQuery"
          icon="close"></paper-icon-button>
    </paper-toolbar>
  </template>
  <script>
    Polymer({
      is: 'om-message-search',
      properties: {
        query: {
          type: String,
          value: null,
        },
      },
      behaviors: [
        Polymer.IronOverlayBehavior,
        Polymer.IronFitBehavior,
      ],
      _hideSearch: function() {
        this.async(function() {
          this.close(); 
        }, 100);
      },
      _resetQuery: function() {
        this.async(function() {
          this.query = null;
        }, 100);
      },
      _blank: function(query) {
        return !!query;
      },
    });
  </script>
</dom-module>
